generator client {
    provider = "prisma-client-js"
    binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
    output = "/home/ubuntu/rechnungsverwaltung_app/nextjs_space/node_modules/.prisma/client"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Rechnung {
  id                  String       @id @default(cuid())
  rechnungsnummer     String       @unique
  datum               DateTime
  lieferant           String
  betragNetto         Decimal      @db.Decimal(10, 2)
  mwstSatz            String
  mwstBetrag          Decimal?     @db.Decimal(10, 2)
  betragBrutto        Decimal      @db.Decimal(10, 2)
  leistungszeitraum   String?
  dateipfad           String?
  status              String?
  verarbeitungsdatum  DateTime?
  typ                 String       @default("Eingang") // "Eingang" (Ausgaben) oder "Ausgang" (Einnahmen)
  createdAt           DateTime     @default(now())
  updatedAt           DateTime     @updatedAt
  extractedInvoiceNum String?
  lastValidated       DateTime?
  validationErrors    String?
  validationStatus    String?      @default("pending")
  audit_logs          audit_logs[]

  @@map("rechnungen")
}

model audit_logs {
  id           String   @id
  rechnungId   String
  action       String
  userId       String?
  userName     String?
  fieldChanged String?
  oldValue     String?
  newValue     String?
  metadata     String?
  ipAddress    String?
  userAgent    String?
  timestamp    DateTime @default(now())
  rechnungen   Rechnung @relation(fields: [rechnungId], references: [id], onDelete: Cascade)

  @@index([rechnungId])
  @@index([timestamp])
}
